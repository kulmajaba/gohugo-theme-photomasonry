{{- $baseFileName := .File.BaseFileName -}}
{{- $imageFileNamePattern := print $baseFileName ".{jpg,jpeg,webp,png,tif,tiff}" -}}
{{- $links := partial "list/photo-links" . -}}

{{- $imageResource := .CurrentSection.Resources.GetMatch $imageFileNamePattern -}}
{{- if not $imageResource -}}
  {{- errorf "Resource not found: %s" $imageFileNamePattern -}}
{{- end -}}
{{- $image := partial "photos/process-photo.html" $imageResource -}}

{{- dict "title" .Title "location" .Params.location "date" (.Date | time.Format "2006") "medium" .Params.medium "alt" (.Params.alt | htmlEscape) "content" .Content "close" .Parent.RelPermalink "pagesPrev" $links.pagesPrev "pagesNext" $links.pagesNext "photoStreamPrev" $links.photoStreamPrev "photoStreamNext" $links.photoStreamNext "src" $image.RelPermalink "style" ("--image-width:{{ $image.Width }};--image-height:{{ $image.Height }};") | jsonify -}}